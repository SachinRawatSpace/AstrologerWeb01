{"version":3,"sources":["views/apps/calls/Streaming.js"],"names":["i","randomID","len","result","chars","maxPos","length","charAt","Math","floor","random","getUrlParams","url","window","location","href","urlStr","split","URLSearchParams","App","roomID","get","role_str","role","ZegoUIKitPrebuilt","Host","Cohost","Audience","sharedLinks","push","name","protocol","host","pathname","kitToken","generateKitTokenForTest","myMeeting","element","zp","create","astroid","localStorage","getItem","joinRoom","container","scenario","mode","LiveStreaming","config","preJoinViewConfig","title","onLiveStart","data","console","log","obj","status","videoliveStream","axiosConfig","post","then","response","setItem","_id","catch","error","onLiveEnd","className","ref","style","width","height"],"mappings":";mSACA,kmGAAAA,GAAA,wBAAAA,EAAA,sBAAAA,GAAA,iBAAAA,GAAA,ssDAAAA,EAAA,yBAAAA,GAAA,IAAAA,EAAA,uBAAAA,GAAA,4bAAAA,EAAA,yBAAAA,GAAA,IAAAA,EAAA,uBAAAA,GAAA,yhBAAAA,EAAA,yBAAAA,GAAA,IAAAA,EAAA,uBAAAA,GAAA,qGAAAA,EAAA,yBAAAA,GAAA,IAAAA,EAAA,uBAAAA,GAAA,sQAEA,SAASC,EAASC,GAChB,IAAIC,EAAS,GACb,GAAIA,EAAQ,OAAOA,EACnB,IAEEH,EAFEI,EAAQ,iEACVC,EAASD,EAAME,OAGjB,IADAJ,EAAMA,GAAO,EACRF,EAAI,EAAGA,EAAIE,EAAKF,IACnBG,GAAUC,EAAMG,OAAOC,KAAKC,MAAMD,KAAKE,SAAWL,IAEpD,OAAOF,EAGF,SAASQ,IAA0C,IAA7BC,EAAG,uDAAGC,OAAOC,SAASC,KAC7CC,EAASJ,EAAIK,MAAM,KAAK,GAC5B,OAAO,IAAIC,gBAAgBF,GAGd,SAASG,IACtB,IAAMC,EAAST,IAAeU,IAAI,WAAapB,EAAS,GACpDqB,EAAWX,EAAaE,OAAOC,SAASC,MAAMM,IAAI,SAAW,OAC3DE,EACS,SAAbD,EACIE,oBAAkBC,KACL,WAAbH,EACAE,oBAAkBE,OAClBF,oBAAkBG,SAEpBC,EAAc,GACdL,IAASC,oBAAkBC,MAAQF,IAASC,oBAAkBE,QAChEE,EAAYC,KAAK,CACfC,KAAM,kBACNlB,IACEC,OAAOC,SAASiB,SAChB,KACAlB,OAAOC,SAASkB,KAChBnB,OAAOC,SAASmB,SAChB,WACAb,EACA,iBAGNQ,EAAYC,KAAK,CACfC,KAAM,mBACNlB,IACEC,OAAOC,SAASiB,SAChB,KACAlB,OAAOC,SAASkB,KAChBnB,OAAOC,SAASmB,SAChB,WACAb,EACA,mBAIJ,IAEMc,EAAWV,oBAAkBW,wBAFrB,UACO,mCAInBf,EACAnB,EAAS,GACTA,EAAS,IAIPmC,EAAS,uCAAG,WAAOC,GAAO,yEAEtBC,EAAKd,oBAAkBe,OAAOL,GAChCM,EAAUC,aAAaC,QAAQ,WAGnCJ,EAAGK,SAAS,CACVC,UAAWP,EACXQ,SAAU,CACRC,KAAMtB,oBAAkBuB,cACxBC,OAAQ,CACNzB,SAGJK,cACAqB,kBAAmB,CACjBC,MAAO,sBAETC,YAAa,SAACC,GACZC,QAAQC,IAAIF,GAKZ,IAAIG,EAAM,CACRf,QAASA,EACTgB,OAAQ,OACRC,gBAAiBrC,GAEnBsC,IACGC,KAAK,sBAAuBJ,GAC5BK,MAAK,SAACC,GAELpB,aAAaqB,QAAQ,gBAAiBD,EAAST,KAAKA,KAAKW,QAQ1DC,OAAM,SAACC,GACNZ,QAAQC,IAAIW,OAKlBC,UAAW,WACTR,IACGrC,IAAI,yBAAD,OAA0BoB,aAAaC,QAAQ,mBAClDkB,MAAK,SAACC,GACLR,QAAQC,IAAI,cAAeO,EAAST,SAErCY,OAAM,SAACC,GACNZ,QAAQC,IAAIW,SAGjB,2CACJ,gBA1DY,sCA4Db,OACE,uBACEE,UAAU,kBACVC,IAAKhC,EACLiC,MAAO,CAAEC,MAAO,QAASC,OAAQ","file":"static/js/184.21f014dc.chunk.js","sourcesContent":["import * as React from \"react\";\nimport { ZegoUIKitPrebuilt } from \"@zegocloud/zego-uikit-prebuilt\";\nimport axiosConfig from \"../../../axiosConfig\";\nfunction randomID(len) {\n  let result = \"\";\n  if (result) return result;\n  var chars = \"12345qwertyuiopasdfgh67890jklmnbvcxzMNBVCZXASDQWERTYHGFUIOLKJP\",\n    maxPos = chars.length,\n    i;\n  len = len || 5;\n  for (i = 0; i < len; i++) {\n    result += chars.charAt(Math.floor(Math.random() * maxPos));\n  }\n  return result;\n}\n\nexport function getUrlParams(url = window.location.href) {\n  let urlStr = url.split(\"?\")[1];\n  return new URLSearchParams(urlStr);\n}\n\nexport default function App() {\n  const roomID = getUrlParams().get(\"roomID\") || randomID(5);\n  let role_str = getUrlParams(window.location.href).get(\"role\") || \"Host\";\n  const role =\n    role_str === \"Host\"\n      ? ZegoUIKitPrebuilt.Host\n      : role_str === \"Cohost\"\n      ? ZegoUIKitPrebuilt.Cohost\n      : ZegoUIKitPrebuilt.Audience;\n\n  let sharedLinks = [];\n  if (role === ZegoUIKitPrebuilt.Host || role === ZegoUIKitPrebuilt.Cohost) {\n    sharedLinks.push({\n      name: \"Join as co-host\",\n      url:\n        window.location.protocol +\n        \"//\" +\n        window.location.host +\n        window.location.pathname +\n        \"?roomID=\" +\n        roomID +\n        \"&role=Cohost\",\n    });\n  }\n  sharedLinks.push({\n    name: \"Join as audience\",\n    url:\n      window.location.protocol +\n      \"//\" +\n      window.location.host +\n      window.location.pathname +\n      \"?roomID=\" +\n      roomID +\n      \"&role=Audience\",\n  });\n  // generate Kit Token\n\n  const appID = 913321685;\n  const serverSecret = \"ec2b5151f49c5376a2e91a5a81a69bc0\";\n  const kitToken = ZegoUIKitPrebuilt.generateKitTokenForTest(\n    appID,\n    serverSecret,\n    roomID,\n    randomID(5),\n    randomID(5)\n  );\n\n  // start the call\n  let myMeeting = async (element) => {\n    // Create instance object from Kit Token.\n    const zp = ZegoUIKitPrebuilt.create(kitToken);\n    let astroid = localStorage.getItem(\"astroId\");\n\n    // start the call\n    zp.joinRoom({\n      container: element,\n      scenario: {\n        mode: ZegoUIKitPrebuilt.LiveStreaming,\n        config: {\n          role,\n        },\n      },\n      sharedLinks,\n      preJoinViewConfig: {\n        title: \"Join Room For Live\", // The title of the prejoin view. Uses \"enter Room\" by default.\n      },\n      onLiveStart: (data) => {\n        console.log(data);\n        // if (localStorage.getItem(\"stopLiveId\") && roomID) {\n        //   alert(\"ASTRO Already Live\");\n        // }\n        // else {\n        let obj = {\n          astroid: astroid,\n          status: \"live\",\n          videoliveStream: roomID,\n        };\n        axiosConfig\n          .post(\"/user/WebliveStream\", obj)\n          .then((response) => {\n            // console.log(\"LIVE Call \", response.data);\n            localStorage.setItem(\"stopLivenewId\", response.data.data._id);\n            // if (localStorage.getItem(\"stopLiveId\")) {\n            //   localStorage.setItem(\"stopLivenewId\", response.data.data._id);\n            // } else {\n            //   localStorage.setItem(\"stopLiveId\", response.data.data?._id);\n            //   this.setState({ status: \"\" });\n            // }\n          })\n          .catch((error) => {\n            console.log(error);\n          });\n        // }\n      },\n\n      onLiveEnd: () => {\n        axiosConfig\n          .get(`/user/closeLiveStream/${localStorage.getItem(\"stopLivenewId\")}`)\n          .then((response) => {\n            console.log(\"Stop LIVE  \", response.data);\n          })\n          .catch((error) => {\n            console.log(error);\n          });\n      },\n    });\n  };\n\n  return (\n    <div\n      className=\"myCallContainer\"\n      ref={myMeeting}\n      style={{ width: \"100vw\", height: \"100vh\" }}\n    ></div>\n  );\n}\n"],"sourceRoot":""}